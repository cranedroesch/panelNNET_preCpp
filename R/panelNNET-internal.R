.Random.seed <-
c(403L, 10L, 1282233761L, -1369846733L, -885177950L, 169063572L, 
-1463123177L, -1667166963L, -1942098908L, -766714870L, 929161589L, 
-158607153L, -2063189034L, 530363264L, -907532349L, 1998917985L, 
482334672L, -1148166354L, 67085017L, 472457451L, 290378074L, 
759462684L, -1862693345L, 969258613L, 2051146508L, -1720639774L, 
-1688308803L, 316613687L, -965433634L, 1638593048L, -1567818373L, 
1217377561L, -1846756952L, -2117079722L, 1483369937L, 31745411L, 
-945857518L, -1462757468L, -321212569L, -261403459L, 1829612596L, 
-1012998246L, -1293534235L, -108677249L, 1371195142L, -1607053168L, 
-182179533L, 1900723921L, -1246401408L, -1168048802L, -728509783L, 
1127423323L, -1106469014L, -368372212L, 317169231L, -1374719227L, 
2079433660L, -575695214L, 421950861L, -1935194681L, -1831094610L, 
57466632L, 1405091083L, 1960147945L, 1554480312L, 1759771494L, 
622522369L, -385999213L, -1052442302L, 489811700L, -769860873L, 
-1636013331L, -1342052988L, -878195798L, -174796523L, -318825553L, 
1447904182L, -1074169376L, -1401415389L, -336662975L, 863650096L, 
1885590350L, -1572234823L, 50308043L, 1092196474L, 749881724L, 
-1379534401L, 1086715541L, -593777492L, 1950733954L, -361021859L, 
-1153244841L, -666080194L, -638508936L, 1592478555L, -70183239L, 
-293590264L, 2021892534L, 718823153L, -1854842589L, 2129292146L, 
-1427783228L, -1624123001L, -1388002467L, 1375866196L, -1622925446L, 
54939333L, -331628513L, -866736218L, 2003859760L, 1903702995L, 
-370177551L, 1099566880L, 1633290686L, -979134007L, 569916795L, 
-1312928950L, -609895508L, 506389167L, 949174373L, 1494200348L, 
53223026L, -441138963L, 1184026919L, 1120525646L, -38539864L, 
-476931669L, 1102049993L, -1556786472L, 2039193478L, 201749089L, 
1511525363L, -1319010718L, -1751840556L, 1430639063L, 1217926093L, 
-1303169180L, 1318470474L, -171007307L, 159838735L, 1010357014L, 
1174699456L, 1563983235L, -1592415L, -711054448L, 1477933166L, 
-592945639L, 2069380779L, 505455258L, 1680981596L, 697531231L, 
731534645L, 1344234700L, 2048806434L, 1214652541L, -1248986761L, 
-93514082L, 1851012440L, 1025127611L, 424520281L, -765136408L, 
-460856298L, -61313135L, 640618563L, 647468882L, 833674212L, 
1313047079L, -1061758339L, -1097522316L, -1035878566L, -1925056091L, 
1550448063L, 207513158L, -2093153072L, 1626210035L, -1147918319L, 
-1695150528L, 1464312350L, -451384087L, -1061038565L, 1483531818L, 
1622948172L, 1349698319L, 774223429L, 1332932604L, -1942563246L, 
340044749L, 752682375L, -1092992914L, -968034232L, 1654200907L, 
-2096949335L, 2082010872L, -1441136090L, -1663902911L, 1276936403L, 
517317762L, 1280295604L, 1085175351L, -1306632915L, -53963196L, 
-456782998L, 980580309L, -651841169L, -1589224330L, 667056032L, 
1849241699L, -398879487L, 238024816L, 1914373134L, 95679609L, 
-581327861L, -150581958L, 277548092L, -2066601089L, -1853990699L, 
350043372L, -393595326L, -1663063651L, -1998951401L, 629166462L, 
-186202312L, 916074523L, 1333641593L, 333342664L, -1419416586L, 
-1080615375L, -1179568029L, -219424718L, -803789252L, -632622862L, 
2014020336L, 2038268740L, 237662808L, -448767430L, 1998782192L, 
-1333918532L, -33057260L, -434964286L, 759355488L, 844633468L, 
1494226128L, 120749090L, -450461016L, -659179636L, -1606774340L, 
1439978546L, -604440768L, 961034420L, 957909832L, 1193507514L, 
-2024982768L, -1711824660L, 1137452116L, 1595952914L, 107133856L, 
1000951756L, 955419488L, 477499586L, 1473570344L, -461838932L, 
-916308164L, 394286962L, 693365552L, -862989788L, 921352248L, 
-334797606L, -143554160L, -2031048964L, 82440084L, -1808577726L, 
-366583296L, -339912132L, 1956830800L, 437926562L, 1713060680L, 
-1843772916L, 684670172L, 1329326674L, 700868736L, -596825260L, 
-172246552L, -1561748742L, -1707915440L, -909108180L, -1362819724L, 
-954853742L, 977472096L, 241488524L, -284046496L, 355529442L, 
-1872723800L, 1649766604L, -654493188L, -554475598L, 1849779696L, 
508347844L, 445214552L, -2029454470L, 912070064L, -1794590276L, 
29562964L, -993989694L, -443292896L, -1015988292L, 1585424976L, 
-1441997342L, -1743302296L, 1433156940L, 295213308L, 1292710642L, 
-1077541120L, 1758479988L, 2023503880L, 833055162L, 1756284880L, 
1310095852L, 1462345620L, -1151946030L, 760053344L, -91744948L, 
-2095790816L, -50261374L, 1049491944L, 420464620L, -1758828996L, 
-856998286L, -724171920L, -472405724L, 1403531832L, -1355918950L, 
-526902832L, -463086148L, -1979844460L, -2012988286L, 1458591168L, 
970466108L, -1960954736L, -1619528926L, -1448563192L, 1925938444L, 
1605522844L, 582909458L, 1555016576L, -892468460L, -478539480L, 
1748413498L, -1371989040L, 1224946284L, 1167960628L, 1420212882L, 
-1293542048L, -1678714548L, 2029963232L, 942335394L, 319999400L, 
913245836L, -70201924L, 1200598642L, 1664211952L, -193038780L, 
-1143158696L, 102119482L, 1733310576L, 862398524L, 1693980948L, 
1111872194L, -1853305120L, 64174204L, -442913072L, -1915164254L, 
1120313384L, 482093836L, 1181700540L, 583545650L, -1853048128L, 
48137268L, -43333944L, 1600554170L, -542062960L, 1210076908L, 
-216954284L, -628071790L, 887148832L, 2047228364L, -1728507168L, 
1285384386L, 1606743080L, -1242773588L, 1644614332L, 717220850L, 
-686969296L, 161789860L, -1991057992L, -610433190L, 1963327632L, 
-502541444L, 1534443796L, 314353986L, -2033739520L, -1623454276L, 
-1168225968L, -130615006L, 2093654600L, 1213081612L, 480814684L, 
-862307886L, -1041142272L, 1692708180L, -2014200600L, 1620506874L, 
-1188127024L, -90506452L, -1092499212L, 621207954L, 342705504L, 
-1529002996L, -367616800L, -562294174L, -1294093144L, -573176756L, 
348450684L, 1259268402L, -992140688L, 743895876L, -1275008040L, 
-644842630L, 450770992L, -1784754244L, -376391084L, -89718718L, 
999999136L, 1725158076L, -1834081328L, -138971806L, -266928408L, 
1833114828L, -1221268996L, -965980686L, 520748160L, 261671412L, 
879891080L, -1519699142L, -487152304L, -1724939156L, 1480400276L, 
-1818154926L, -184889888L, -1895267124L, -190755168L, 1998987650L, 
-1507053336L, -2116670740L, 711777596L, -1776891790L, 1264480880L, 
-59577956L, 200286989L, 285803895L, -551923328L, 1482819550L, 
1204486315L, 854975405L, 510363674L, -453865768L, 508133185L, 
1301110771L, -51011052L, 1095953314L, -903113545L, -292585855L, 
883623558L, -2101977404L, -333455371L, -90708385L, -626081608L, 
709756310L, -297506909L, -464876699L, 1858587266L, 44009456L, 
-188374631L, 1917972363L, -567645572L, 1597921450L, -588350753L, 
956917865L, 680878718L, -368805268L, -1053657411L, 193424263L, 
2062303088L, 1018152462L, 172432187L, -2136004579L, 854626506L, 
25070568L, 65681617L, -501832509L, 1029700548L, 1188356210L, 
-1528041145L, 1331633425L, 751618198L, 417369588L, -1520124027L, 
1355431631L, 1626848200L, -732857754L, 597419155L, -4322315L, 
460811730L, -412557792L, 833699849L, 1049777467L, -1950902132L, 
-1378519782L, -1081410673L, -480262951L, -1077326994L, -1719948548L, 
1723947117L, 1611756567L, -542480928L, 1156755902L, 1281976203L, 
2012751885L, 1060241466L, 1395101816L, 434052129L, -638746925L, 
1730502132L, 853704322L, 1610644247L, -578340383L, -1105254618L, 
1324413476L, -890829611L, -50383745L, -567125736L, 1091725366L, 
-907493693L, 112800517L, -2106845534L, 918647952L, 69821497L, 
1766817003L, 1908981212L, -430717942L, 1377612543L, 1339353929L, 
-1663016738L, -1374101876L, 206395997L, -1843971993L, 1225549200L, 
700425646L, 2030821467L, -777066435L, 408465066L, -1019905208L, 
68374385L, 477452515L, -1685463068L, -1870924014L, 1485990631L, 
-1850577743L, -1479958794L, 571517204L, -1519784411L, 1928201007L, 
1528120552L, -283695674L, -2060491661L, -477450539L, -1642744654L, 
1231911040L, -409873303L, -1015602981L, 231965740L, 906058810L, 
-1202615569L, 816067961L, -1281398258L, -1996063780L, -1927941043L, 
1849829303L, 1216436544L, -1583849442L, -1294809365L, 2110752365L, 
-960483622L, 265768600L, -928361215L, -191309133L, -1981745708L, 
-857496350L, 1738599799L, 1554617537L, -1139627962L, 1210333060L, 
-687263435L, -537063649L, -1761623432L, -539379882L, -562350621L, 
-2065937499L, -681231806L, -257943504L, 261987417L, 1202438603L, 
-1863454148L, -1922851734L, -518062433L, 1428161321L, 2080485310L, 
1859673772L, -1797938179L, -558236857L, -1818592208L, -612512434L, 
1175856507L, 1659740893L, 976782090L, 1936769576L, -310201523L
)
.rgedit.lastline2clipboard <-
function( clipboard.command = "xclip" ) 
{
  # The possible clipboard commands:
  clipboard.commands <- c( "xclip", "xsel", "pbcopy" );
  # The correct command line depending on the option used:
  pipe.commands <- c( "xclip -i -selection clipboard", "xsel --clipboard", "pbcopy" );
  names(pipe.commands) <- clipboard.commands;

  # Try to detect which clipboard commands are installed in the system:
  available.clipboard.commands <- c( FALSE, FALSE, FALSE ); names(available.clipboard.commands) <- clipboard.commands;
  for( i in 1:length(available.clipboard.commands) )
  {
    available.clipboard.commands[i] <- length(system( paste( "command -v ", names(available.clipboard.commands)[i], sep=""), intern=TRUE )) > 0;
  } 
  if( sum(available.clipboard.commands) == 0 )
  {
    stop( "No cpliboard manipulation programs installed on your machine! Please install xclip or xsel (on *nix) and pbcopy (on MacOSX)!\n" );
  }

  # Try to satisfly the user's preference:
  if( sum(clipboard.command == names(pipe.commands)) == 0 )
  {
    # Unknown clipboard command: print a warning and try your best:
    cat( "Warning: unknown option ", clipboard.command );
    clipboard.command = (names(available.clipboard.commands)[available.clipboard.commands])[1];
    cat( " -- using ", clipboard.command, " instead...\n" );
  }
  else if( !available.clipboard.commands[clipboard.command] )
  {
    # Preferred command not installed: print a warning and try your best:
    cat( "Warning: requested command ", clipboard.command );
    clipboard.command = (names(available.clipboard.commands)[available.clipboard.commands])[1];
    cat( " -- using ", clipboard.command, " instead...\n" );
  }

  # Save whole shitory to temporaty file:
  hist.file <- tempfile( "Rhistory" );
  savehistory( hist.file );
  full.hist <- readLines( hist.file );
  unlink( hist.file );

  # Read the last line before this one:
  last.line <- full.hist[ length(full.hist)-1 ];
 
  # And copy it to the clipboard: 
  clipboard.pipe <- pipe( pipe.commands[clipboard.command], "w" );
  cat( paste(last.line,"\n",sep=""), file=clipboard.pipe );
  close( clipboard.pipe );
  
  # Restore the history without the last command:
  hist.file <- tempfile( "Rhistory" );
  writeLines( full.hist[ -length(full.hist) ], hist.file );
  loadhistory( hist.file );
  unlink( hist.file );
}
